import { MalwareBazaar } from "~/searcher";

describe("MalwareBazaar", function () {
  const subject = new MalwareBazaar();

  it("should support hash", function () {
    expect(subject.supportedTypes).toEqual(["hash"]);
  });

  describe("#searchByHash", function () {
    describe("when md5 is given", function () {
      const md5 = "44d88612fea8a8f36de82e1278abb02f";
      it("should return a URL", function () {
        expect(subject.searchByHash(md5)._unsafeUnwrap()).toBe(
          `https://bazaar.abuse.ch/browse.php?search=md5%3A${md5}`,
        );
      });
    });

    describe("when sha1 is given", function () {
      const sha1 = "3395856ce81f2b7382dee72602f798b642f14140";
      it("should return a URL", function () {
        expect(subject.searchByHash(sha1)._unsafeUnwrap()).toBe(
          `https://bazaar.abuse.ch/browse.php?search=sha1%3A${sha1}`,
        );
      });
    });

    describe("when sha256 is given", function () {
      const sha256 =
        "275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f";
      it("should return a URL", function () {
        expect(subject.searchByHash(sha256)._unsafeUnwrap()).toBe(
          `https://bazaar.abuse.ch/browse.php?search=sha256%3A${sha256}`,
        );
      });
    });
  });
});
